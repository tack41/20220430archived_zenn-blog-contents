---
title: "ADç’°å¢ƒã®Windowsã‚’Ansibleã§æ“ä½œã™ã‚‹(éADç’°å¢ƒ)"
emoji: "ğŸ’­"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [windows,ansible,ubuntu]
published: true
---

## TL;DR

Active Directryã«å‚åŠ ã—ã¦ã„ãªã„Window10ã‚’WSL2ã®Ubuntu20.04ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸAnsibleã§æ“ä½œã™ã‚‹ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚kerberosèªè¨¼ãŒå¿…è¦ãªã„åˆ†ã€ADå‚åŠ æ¸ˆã¿ã®ç’°å¢ƒã‚ˆã‚Šã¯ç°¡å˜ãªæ‰‹é †ã§ã—ãŸã€‚

## æ‰‹é †

### Windows 10

1. WSL2ã‚’æœ‰åŠ¹ã«ã—ã€Ubuntu20.04ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
1. ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šã‚’å—ã‘ä»˜ã‘ã‚‹ãŸã‚ã®è¨­å®š(è¦ç®¡ç†è€…æ¨©é™)

   ```powershell
   Invoke-WebRequest -Uri https://raw.githubusercontent.com/ansible/ansible/devel/examples/scripts/ConfigureRemotingForAnsible.ps1 -OutFile ConfigureRemotingForAnsible.ps1
   powershell -ExecutionPolicy RemoteSigned .\ConfigureRemotingForAnsible.ps1
   ```

### Ubuntu20.04

1. æœ€æ–°ã®Ansibleã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

   ```bash
   sudo apt update
   sudo apt install software-properties-common
   sudo apt-add-repository --yes --update ppa:ansible/ansible
   sudo apt install ansible
   ```

   * [https://docs.ansible.com/ansible/2.9_ja/installation_guide/intro_installation.html#ubuntu-ansible](https://docs.ansible.com/ansible/2.9_ja/installation_guide/intro_installation.html#ubuntu-ansible)
1. ä»¥ä¸‹ã®aptãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   * python3-pip
   * gcc
1. pip3ã§ä»¥ä¸‹ã®Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   * pywinrm
1. `inventory.yml`ã«ä»¥ä¸‹ã®è¨˜è¿°ã‚’è¨˜è¼‰

   ```yaml
   windows:
     hosts:
       192.168.yy.yyy:
         ansible_connection: winrm
         ansible_user: user_name
         ansible_winrm_server_cert_validation: ignore
         ansible_winrm_transport: basic
         ansible_port: 5986
   ```

1. `ansible -i inventory.yml 192.168.yyy.yyy -m win_ping` ãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèª
